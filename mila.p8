pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
--variables
function _init()
  player={
    sp=1,
    x=59,
    y=59,
    w=8,
    h=8,
    flp=false,
    dx=0,
    dy=0,
    max_dx=2,
    max_dy=3,
    acc=0.5,
    boost=4,
    anim=0,
    running=false,
    jumping=false,
    falling=false,
    sliding=false,
    landed=false,
  }
  
  gravity=0.3
  friction=0.85
end



-->8
--update and draw

function _update()
  player_update()
  player_animate()
  
end

function _draw()
  cls()
  map(0,0)
  spr(player.sp,player.x,player.y,1,1,player.flp)
end
-->8
--collisions

function collide_map(obj,aim,flag)
 --obj = table x,y,h,w
 --aim = left,right,up,down
 
 local x=obj.x local y=obj.y
 local h=obj.h local w=obj.w
 
 local x1=0 local y1=0
 local x2=0 local y2=0
 
 if aim=="left" then
   x1=x-1  y1=y
   x2=x    y2=y+h-1
   
 elseif aim=="right" then
   x1=x+w   y1=y
   x2=x+w+1 y2=y+h-1
   
 elseif aim=="up" then
   x1=x+1   y1=y-1
   x2=x+w-1 y2=y
 
 elseif aim=="down" then
   x1=x     y1=y+h
   x2=x+w   y2=y+h
    
 end
 
 --pixels to tiles
 x1/=8    y1/=8
 x2/=8    y2/=8
 
 if fget(mget(x1,y1), flag)
 or fget(mget(x1,y2), flag)
 or fget(mget(x2,y1), flag)
 or fget(mget(x2,y2), flag) then
   return true 
 else
   return false
 end
end
-->8
--player

function player_update()
  --physics
  player.dy+=gravity
  player.dx*=friction
  
  --controls
  if btn(⬅️) then
    player.dx-=player.acc
    player.running=true
    player.flp=true
  end
  if btn(➡️) then
    player.dx-=player.acc
    player.running=true
    player.flp=true
  end
  
  --slide
  if player.running
  and not btn(⬅️)
  and not btn(➡️)
  and not player.falling
  and not player.jumping then 
    player.running=false
    player.sliding=false
  end
  
  --jump
  if btnp(❎)
  and player.landed then
     player.dy-=player.boost
     player.landed=false
  end
  
  --check collision up and down
  if player.dy>0 then
    player.falling=true
    player.landed=false
    player.jumping=false
    
    if collide_map(player,"down",0) then
      player.landed=true
      player.falling=false
      player.dy=0
      player.y-=(player.y+player.h)
  end
  
  player.x+=player.dx
  player.y+=player.dy
  
__gfx__
00000000099999900999999000999999009999999009999900999999000999999909999900000000000000000000000000000000000000000000000000000000
00000000999999909999999009099999000999990999999900099999909999990099999909999900000000000000000000000000000000000000000000000000
0070070009f7cfc009f7cfc0909f7cfc909ff7cf909f7cfc909ff7cf990ff7cf000ff7cf99999900000000000000000000000000000000000000000000000000
0007700090fffff090fffef0000fffef000ffffe000fffef000ffffe000ffffe000ffffe9f7cfc00000000000000000000000000000000000000000000000000
00077000000220000022220000f2220000f2220000f2220000f2220000022200000022200fffef00000000000000000000000000000000000000000000000000
00700700002222000f0220f00000220000002200000022000000220000f022000000220f002222f0000000000000000000000000000000000000000000000000
000000000f01d0f00001d00000110d000001d00000dd0100000d1000000d1000000001600f022d00000000000000000000000000000000000000000000000000
0000000000100d0000100d0000000d000001d00000000100000d100000d100000000001d000011dd000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb00bbbbbbbbbbbb0000000000000000000000000000000000000000000000000000000000000000000000000000000000
3bbb3bbb3bbb33bb3bbb333b3bbbbbb30bbbb3b3bbb3bbb000000000000000000000000000000000000000000000000000000000000000000000000000000000
333333b33b33333333b3443b33433b34bb3b34343b3433bb00000000000000000000000000000000000000000000000000000000000000000000000000000000
4b3444344b4443344334443344443334bbb33444434443bb00000000000000000000000000000000000000000000000000000000000000000000000000000000
4b3424444344444444342443444443b4bb3444424444443b00000000000000000000000000000000000000000000000000000000000000000000000000000000
43444444444244444444449394424334b3444444449443bb00000000000000000000000000000000000000000000000000000000000000000000000000000000
494444c4444444e44444444444444344bb344d444444443b00000000000000000000000000000000000000000000000000000000000000000000000000000000
444444444444444448444444444444a4334444444444444300000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
49444444422444444444544444448444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4444444442e244494444444444444444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
444448444422444445dd44444d444744000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
444444444444444445ddd44444444774000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44d4444444444f44445554f444447644000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
444444f44d4444444444444444776444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
44444444444444444444444444474444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
ee2ee2eeeee2eeee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeee2eee2eeeee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e2eeeeeeeeeeeeee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeee2eeeeee22e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222222222220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
002ee200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
002ee200002e22000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0022e200002ee2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0022e2000022e2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
002ee200002e22000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
002ee200002ee2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
002e2200002ee2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
002ee200002ee2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0022e2000022e2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003030303030300000000000000000000000000000000000000000000000000000101000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000656565650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000656565000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000061606160610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000444500000000710071000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000044505141450000700071000000005454000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4340434052505052504241414142424054545454000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5051525050535050525051505053505054545454000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
